# Git 命令大全 - 详细注释版

## 目录
1. [基础配置](#基础配置)
2. [仓库初始化](#仓库初始化)
3. [文件操作](#文件操作)
4. [提交管理](#提交管理)
5. [分支管理](#分支管理)
6. [远程仓库](#远程仓库)
7. [查看信息](#查看信息)
8. [撤销操作](#撤销操作)
9. [标签管理](#标签管理)
10. [合并与变基](#合并与变基)
11. [暂存操作](#暂存操作)
12. [高级操作](#高级操作)
13. [常用工作流程](#常用工作流程)

---

## 基础配置

### 配置用户信息

```bash
# 设置全局用户名（所有仓库共用）
git config --global user.name "你的名字"

# 设置全局邮箱（所有仓库共用）
git config --global user.email "your.email@example.com"

# 设置当前仓库的用户名（仅当前仓库）
git config user.name "你的名字"

# 设置当前仓库的邮箱（仅当前仓库）
git config user.email "your.email@example.com"

# 查看所有配置
git config --list

# 查看全局配置
git config --global --list

# 查看当前仓库配置
git config --list --local

# 查看特定配置项
git config user.name
git config user.email

# 编辑配置文件
git config --global --edit  # 编辑全局配置
git config --edit           # 编辑当前仓库配置
```

### 其他配置

```bash
# 设置默认编辑器（如 vim, nano, code）
git config --global core.editor "code --wait"

# 设置默认分支名（Git 2.28+）
git config --global init.defaultBranch main

# 设置自动转换换行符（Windows 推荐）
git config --global core.autocrlf true

# 设置自动转换换行符（Mac/Linux 推荐）
git config --global core.autocrlf input

# 设置颜色输出
git config --global color.ui auto

# 设置别名（简化命令）
git config --global alias.st status          # git st = git status
git config --global alias.co checkout        # git co = git checkout
git config --global alias.br branch          # git br = git branch
git config --global alias.ci commit         # git ci = git commit
git config --global alias.unstage 'reset HEAD --'  # git unstage = git reset HEAD --

# 删除配置
git config --global --unset user.name
```

---

## 仓库初始化

### 创建新仓库

```bash
# 在当前目录初始化 Git 仓库
git init

# 在指定目录初始化 Git 仓库
git init 目录名

# 初始化并设置默认分支为 main
git init -b main

# 初始化裸仓库（用于服务器，不包含工作目录）
git init --bare
```

### 克隆仓库

```bash
# 克隆远程仓库（HTTPS）
git clone https://github.com/用户名/仓库名.git

# 克隆远程仓库（SSH）
git clone git@github.com:用户名/仓库名.git

# 克隆到指定目录
git clone https://github.com/用户名/仓库名.git 目录名

# 克隆指定分支
git clone -b 分支名 https://github.com/用户名/仓库名.git

# 克隆时只获取最新提交（浅克隆，节省空间）
git clone --depth 1 https://github.com/用户名/仓库名.git

# 克隆所有分支
git clone --mirror https://github.com/用户名/仓库名.git
```

---

## 文件操作

### 查看状态

```bash
# 查看工作区状态（最常用）
git status

# 简短格式显示状态
git status -s
git status --short

# 显示未跟踪的文件
git status -u
git status --untracked-files=all
```

### 添加文件

```bash
# 添加所有文件到暂存区
git add .

# 添加指定文件
git add 文件名.py
git add 文件1.py 文件2.py

# 添加指定目录下的所有文件
git add 目录名/

# 添加所有 .py 文件
git add *.py

# 交互式添加（可以选择性添加文件的部分内容）
git add -p
git add --patch

# 添加所有修改和删除的文件（不包括新文件）
git add -u
git add --update

# 添加所有文件（包括删除的）
git add -A
git add --all

# 强制添加（即使文件被 .gitignore 忽略）
git add -f 文件名
```

### 移除文件

```bash
# 从 Git 中删除文件（同时删除工作区文件）
git rm 文件名

# 从 Git 中删除文件（保留工作区文件）
git rm --cached 文件名

# 删除目录
git rm -r 目录名

# 强制删除
git rm -f 文件名
```

### 移动/重命名文件

```bash
# 移动或重命名文件（Git 会自动检测）
git mv 旧文件名 新文件名

# 或者手动操作后
mv 旧文件名 新文件名
git add 新文件名
git rm 旧文件名
```

---

## 提交管理

### 创建提交

```bash
# 提交暂存区的所有更改
git commit -m "提交信息"

# 提交并添加详细描述
git commit -m "标题" -m "详细描述"

# 提交时自动添加所有已跟踪文件的修改（不包括新文件）
git commit -a -m "提交信息"
git commit -am "提交信息"

# 修改最后一次提交（如果还没推送）
git commit --amend -m "新的提交信息"

# 修改最后一次提交，同时修改文件
git add 文件
git commit --amend --no-edit  # 不修改提交信息
git commit --amend            # 修改提交信息

# 空提交（用于触发 CI/CD 等）
git commit --allow-empty -m "空提交"
```

### 查看提交历史

```bash
# 查看提交历史
git log

# 单行显示提交历史
git log --oneline

# 显示最近 N 条提交
git log -5
git log -5 --oneline

# 图形化显示分支
git log --graph --oneline --all

# 显示文件修改统计
git log --stat

# 显示文件具体改动
git log -p

# 搜索提交信息
git log --grep="关键词"

# 按作者搜索
git log --author="作者名"

# 按日期范围搜索
git log --since="2025-01-01" --until="2025-01-31"

# 查看某个文件的提交历史
git log 文件名

# 查看提交的简略统计
git log --oneline --graph --decorate --all
```

### 查看差异

```bash
# 查看工作区与暂存区的差异
git diff

# 查看暂存区与最后一次提交的差异
git diff --staged
git diff --cached

# 查看两次提交之间的差异
git diff 提交1 提交2

# 查看与某个分支的差异
git diff 分支名

# 查看某个文件的差异
git diff 文件名

# 查看统计信息
git diff --stat
```

---

## 分支管理

### 查看分支

```bash
# 查看本地分支
git branch

# 查看所有分支（包括远程）
git branch -a

# 查看远程分支
git branch -r

# 查看分支详细信息
git branch -v

# 查看已合并的分支
git branch --merged

# 查看未合并的分支
git branch --no-merged
```

### 创建分支

```bash
# 创建新分支（不切换）
git branch 分支名

# 创建并切换到新分支
git checkout -b 分支名

# 或者使用新命令（Git 2.23+）
git switch -c 分支名

# 基于指定提交创建分支
git branch 分支名 提交ID

# 基于远程分支创建本地分支
git branch 本地分支名 origin/远程分支名
```

### 切换分支

```bash
# 切换到指定分支
git checkout 分支名

# 使用新命令切换分支（Git 2.23+）
git switch 分支名

# 切换到上一个分支
git checkout -
git switch -

# 创建并切换到新分支
git checkout -b 新分支名
git switch -c 新分支名
```

### 删除分支

```bash
# 删除已合并的分支
git branch -d 分支名

# 强制删除分支（即使未合并）
git branch -D 分支名

# 删除远程分支
git push origin --delete 分支名
git push origin :分支名  # 旧语法
```

### 重命名分支

```bash
# 重命名当前分支
git branch -m 新分支名

# 重命名指定分支
git branch -m 旧分支名 新分支名
```

---

## 远程仓库

### 查看远程仓库

```bash
# 查看远程仓库列表
git remote

# 查看远程仓库详细信息（包括 URL）
git remote -v

# 查看远程仓库详细信息
git remote show origin
```

### 添加远程仓库

```bash
# 添加远程仓库
git remote add origin https://github.com/用户名/仓库名.git

# 添加多个远程仓库
git remote add upstream https://github.com/上游用户/仓库名.git
```

### 更新远程仓库地址

```bash
# 更新远程仓库 URL
git remote set-url origin https://github.com/新用户名/新仓库名.git

# 更新为 SSH 地址
git remote set-url origin git@github.com:用户名/仓库名.git
```

### 删除远程仓库

```bash
# 删除远程仓库
git remote remove origin

# 或者
git remote rm origin
```

### 推送（Push）

```bash
# 推送到远程仓库（第一次）
git push -u origin main
git push -u origin master

# 推送到远程仓库（之后）
git push

# 推送到指定分支
git push origin 分支名

# 推送所有分支
git push --all origin

# 推送所有标签
git push --tags

# 强制推送（危险，会覆盖远程历史）
git push -f origin 分支名
git push --force origin 分支名

# 强制推送（更安全，会检查）
git push --force-with-lease origin 分支名
```

### 拉取（Pull）

```bash
# 拉取并合并远程更改
git pull

# 拉取指定分支
git pull origin 分支名

# 拉取但不合并（只更新远程分支信息）
git fetch

# 拉取所有远程分支
git fetch --all

# 拉取并显示详细信息
git pull --verbose
```

### 获取（Fetch）

```bash
# 获取远程更新（不合并）
git fetch

# 获取指定远程仓库
git fetch origin

# 获取所有远程仓库
git fetch --all

# 获取并删除远程已删除的分支
git fetch --prune
git fetch -p
```

---

## 查看信息

### 查看状态

```bash
# 查看工作区状态
git status

# 简短格式
git status -s

# 显示未跟踪的文件
git status -u
```

### 查看提交

```bash
# 查看提交历史
git log

# 单行显示
git log --oneline

# 图形化显示
git log --graph --oneline --all

# 查看最近 N 条
git log -5

# 查看文件改动
git log -p

# 查看统计
git log --stat
```

### 查看文件

```bash
# 查看文件内容（指定提交）
git show 提交ID:文件名

# 查看最后一次提交的某个文件
git show HEAD:文件名

# 查看某个分支的某个文件
git show 分支名:文件名
```

### 查看差异

```bash
# 工作区 vs 暂存区
git diff

# 暂存区 vs 最后一次提交
git diff --staged

# 两次提交之间的差异
git diff 提交1 提交2

# 与某个分支的差异
git diff 分支名
```

### 查看分支关系

```bash
# 查看分支合并图
git log --graph --oneline --all

# 查看分支关系
git show-branch
```

---

## 撤销操作

### 撤销工作区修改

```bash
# 撤销工作区的修改（危险，会丢失修改）
git checkout -- 文件名

# 撤销所有工作区修改
git checkout -- .

# 使用新命令（Git 2.23+）
git restore 文件名
git restore .
```

### 撤销暂存区

```bash
# 将文件从暂存区移除（保留工作区修改）
git reset HEAD 文件名

# 移除所有暂存区文件
git reset HEAD

# 使用新命令（Git 2.23+）
git restore --staged 文件名
git restore --staged .
```

### 撤销提交

```bash
# 撤销最后一次提交（保留修改在暂存区）
git reset --soft HEAD~1

# 撤销最后一次提交（保留修改在工作区）
git reset --mixed HEAD~1
git reset HEAD~1  # 默认是 mixed

# 撤销最后一次提交（完全删除修改）
git reset --hard HEAD~1

# 撤销到指定提交
git reset --hard 提交ID

# 修改最后一次提交
git commit --amend -m "新的提交信息"
```

### 恢复文件

```bash
# 从最后一次提交恢复文件
git checkout HEAD -- 文件名

# 从指定提交恢复文件
git checkout 提交ID -- 文件名

# 使用新命令
git restore --source=HEAD 文件名
```

---

## 标签管理

### 创建标签

```bash
# 创建轻量标签
git tag 标签名

# 创建附注标签（推荐）
git tag -a 标签名 -m "标签说明"

# 在指定提交创建标签
git tag -a 标签名 提交ID -m "标签说明"

# 创建带签名的标签
git tag -s 标签名 -m "标签说明"
```

### 查看标签

```bash
# 查看所有标签
git tag

# 查看标签详细信息
git show 标签名

# 搜索标签
git tag -l "v1.*"
```

### 删除标签

```bash
# 删除本地标签
git tag -d 标签名

# 删除远程标签
git push origin --delete 标签名
git push origin :refs/tags/标签名
```

### 推送标签

```bash
# 推送指定标签
git push origin 标签名

# 推送所有标签
git push --tags
git push origin --tags
```

---

## 合并与变基

### 合并（Merge）

```bash
# 合并指定分支到当前分支
git merge 分支名

# 合并时创建合并提交（即使可以快进）
git merge --no-ff 分支名

# 合并时只快进（如果不能快进则失败）
git merge --ff-only 分支名

# 合并时显示统计信息
git merge --stat 分支名

# 取消合并（合并冲突时）
git merge --abort
```

### 变基（Rebase）

```bash
# 将当前分支变基到指定分支
git rebase 分支名

# 交互式变基（可以修改、删除、合并提交）
git rebase -i HEAD~3  # 最近3个提交
git rebase -i 提交ID

# 继续变基（解决冲突后）
git rebase --continue

# 跳过当前提交
git rebase --skip

# 取消变基
git rebase --abort
```

### 解决冲突

```bash
# 查看冲突文件
git status

# 手动解决冲突后
git add 冲突文件
git commit  # 或 git rebase --continue

# 使用工具解决冲突
git mergetool

# 接受某一方的全部更改
git checkout --ours 文件名    # 接受当前分支
git checkout --theirs 文件名  # 接受合并分支
```

---

## 暂存操作

### 暂存（Stash）

```bash
# 暂存当前修改
git stash

# 暂存并添加说明
git stash save "说明信息"

# 暂存包括未跟踪的文件
git stash -u
git stash --include-untracked

# 查看暂存列表
git stash list

# 查看暂存内容
git stash show
git stash show -p  # 显示详细差异

# 应用暂存（保留暂存）
git stash apply

# 应用指定暂存
git stash apply stash@{0}

# 应用并删除暂存
git stash pop

# 删除暂存
git stash drop stash@{0}

# 清空所有暂存
git stash clear
```

---

## 高级操作

### 清理

```bash
# 删除未跟踪的文件
git clean -n  # 预览（dry-run）
git clean -f  # 删除文件
git clean -fd # 删除文件和目录

# 交互式清理
git clean -i
```

### 搜索

```bash
# 在代码中搜索
git grep "关键词"

# 在指定提交中搜索
git grep "关键词" 提交ID

# 显示行号
git grep -n "关键词"
```

### 子模块（Submodule）

```bash
# 添加子模块
git submodule add https://github.com/用户/仓库.git 路径

# 初始化子模块
git submodule init

# 更新子模块
git submodule update

# 初始化和更新一起
git submodule update --init --recursive

# 克隆包含子模块的仓库
git clone --recursive https://github.com/用户/仓库.git
```

# ========== 查看帮助 ==========

# 查看命令帮助
git help 命令名
git 命令名 --help

# 查看 Git 版本
git --version

# ========== 清理 ==========

# 删除未跟踪的文件（预览）
git clean -n

# 删除未跟踪的文件
git clean -f

# 删除未跟踪的文件和目录
git clean -fd

# ========== 搜索 ==========

# 在代码中搜索
git grep "关键词"

# 显示行号
git grep -n "关键词"

# ========== 显示文件修改信息 ==========

# 显示文件每一行的最后修改信息
git blame 文件名

# 查看文件内容（指定提交）
git show 提交ID:文件名

# ========== 日常开发流程 ==========

# 1. 查看状态
git status

# 2. 添加文件
git add .

# 3. 提交
git commit -m "提交信息"

# 4. 推送
git push

# ========== 创建功能分支流程 ==========

# 1. 创建并切换分支
git checkout -b feature/新功能

# 2. 开发并提交
git add .
git commit -m "实现新功能"

# 3. 推送到远程
git push -u origin feature/新功能

# 4. 合并到主分支
git checkout main
git merge feature/新功能

# 5. 删除功能分支
git branch -d feature/新功能
git push origin --delete feature/新功能

命令速查表
操作	命令
初始化	git init
克隆	git clone <url>
状态	git status
添加	git add .
提交	git commit -m "信息"
推送	git push
拉取	git pull
查看日志	git log --oneline
创建分支	git checkout -b 分支名
切换分支	git checkout 分支名
合并分支	git merge 分支名
删除分支	git branch -d 分支名
查看差异	git diff
撤销修改	git checkout -- 文件
暂存修改	git stash
应用暂存	git stash pop